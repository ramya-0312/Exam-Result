<div class="container mt-5">
  <div class="text-center mb-4">
    <h3 class="fw-bold text-uppercase">Welcome to Office of the Controller of Examination</h3>
    <h5 class="text-center">Pre-Examination Monitoring System</h5>
  </div>

  <!-- Tabs -->
  <div class="d-flex justify-content-center mb-0">
    <button class="btn me-2"
      [ngClass]="{'btn-primary': activeTab === 'profile', 'btn-outline-primary': activeTab !== 'profile'}"
      (click)="activeTab = 'profile'">
      Profile
    </button>

    <button class="btn"
      [ngClass]="{'btn-primary': activeTab === 'result', 'btn-outline-primary': activeTab !== 'result'}"
      (click)="loadResults()">
      Exam Result
    </button>
  </div>

  <!-- Profile View -->
  <div *ngIf="activeTab === 'profile'" class="border p-4 rounded mb-4 bg-light shadow-sm">
    <h5 class="mb-3 fw-bold text-center">Student Profile</h5>
    <div><strong>Name:</strong> {{ student?.name }}</div>
    <div><strong>Register Number:</strong> {{ student?.registerNumber }}</div>
    <div><strong>Department:</strong> {{ student?.department }}</div>
    <div><strong>Semester:</strong> {{ student?.semester }}</div>
  </div>

  <!-- Exam Result View -->
  <div *ngIf="activeTab === 'result'">

    <!-- Loading Spinner (visible when isLoading is true) -->
    <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center" style="height: 100vh;">
      <div class="spinner"></div>
      <p class="ms-3">Loading your results...</p>
    </div>

    <!-- Result Content (visible after 5 seconds) -->
    <div *ngIf="!isLoading">
      <div class="border p-4 rounded mb-4 bg-light shadow-sm">
        <div class="row">
          <div class="col-md-6"><strong>Name:</strong> {{ student?.name }}</div>
          <div class="col-md-6"><strong>Register Number:</strong> {{ student?.registerNumber }}</div>
          <div class="col-md-6"><strong>Department:</strong> {{ student?.department }}</div>
          <div class="col-md-6"><strong>Semester:</strong> {{ student?.semester }}</div>
        </div>
      </div>

      <div class="table-responsive">
        <table class="table table-bordered text-center align-middle shadow-sm">
          <thead class="table-dark">
            <tr>
              <th>Subject</th>
              <th>Marks</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let subject of student?.marks">
              <td>{{ subject.subject }}</td>
              <td>{{ subject.mark }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mt-4 p-4 rounded text-center shadow-sm"
          [ngClass]="{
            'bg-success text-white': student?.result === 'Pass',
            'bg-danger text-white': student?.result === 'Fail'
          }">
        <h5>Total Marks: {{ student?.total }}</h5>
        <h5>Percentage: {{ getPercentage() }}%</h5>
        <h5>Result: {{ student?.result }}</h5>
      </div>

      <div class="text-center mt-4">
        <button class="btn btn-secondary me-2" (click)="goHome()">Back to Home</button>
        <button class="btn btn-primary" (click)="printPage()">Print</button>
      </div>

    </div>
  </div>

</div>

<style>
  /* Add a spinner animation */
  .spinner {
    border: 5px solid #f3f3f3;
    border-top: 5px solid #3498db;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg);}
  }
</style>
